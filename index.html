<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
  <title>Smart Chat Optimizer - AI Code Generator</title>
  <style>
    :root { 
      --bg: #0b1020; 
      --card: #111a2b; 
      --text: #e8eafc; 
      --muted: #a6b0d8; 
      --user: #2b5cff; 
      --bot: #1f9a3a; 
      --code: #0e1b2a; 
      --accent: #4ade80;
      --danger: #ef4444;
      --warning: #f59e0b;
    }
    
    * { box-sizing: border-box; }
    html, body { height: 100vh; margin: 0; overflow: hidden; }
    
    body { 
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
      background: linear-gradient(135deg, var(--bg) 0%, #1a1a2e 100%);
      color: var(--text); 
      display: flex; 
      flex-direction: column;
      touch-action: manipulation;
    }

    .header {
      background: rgba(17, 26, 43, 0.95);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid #2d2d4a;
      padding: 12px 16px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-shrink: 0;
    }

    .logo {
      font-size: 1.2rem;
      font-weight: 700;
      color: var(--accent);
    }

    .status {
      display: flex;
      gap: 8px;
      align-items: center;
      font-size: 0.85rem;
    }

    .status-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: var(--accent);
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }

    .main-container {
      flex: 1;
      display: flex;
      overflow: hidden;
    }

    .chat-section {
      flex: 1;
      display: flex;
      flex-direction: column;
      min-width: 0;
    }

    .controls-section {
      width: 320px;
      background: rgba(17, 26, 43, 0.8);
      border-left: 1px solid #2d2d4a;
      overflow-y: auto;
      flex-shrink: 0;
    }

    @media (max-width: 1024px) {
      .controls-section {
        position: fixed;
        top: 0;
        right: -320px;
        height: 100vh;
        z-index: 1000;
        transition: right 0.3s ease;
        box-shadow: -4px 0 20px rgba(0,0,0,0.3);
      }
      
      .controls-section.open {
        right: 0;
      }
      
      .overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0,0,0,0.5);
        z-index: 999;
        opacity: 0;
        visibility: hidden;
        transition: all 0.3s ease;
      }
      
      .overlay.show {
        opacity: 1;
        visibility: visible;
      }
    }

    .toggle-btn {
      display: none;
      background: var(--accent);
      color: #062f1c;
      border: none;
      padding: 8px 12px;
      border-radius: 6px;
      font-size: 0.85rem;
      font-weight: 600;
      cursor: pointer;
      touch-action: manipulation;
    }

    @media (max-width: 1024px) {
      .toggle-btn { display: block; }
    }

    #chat {
      flex: 1;
      overflow-y: auto;
      padding: 16px;
      background: rgba(10, 18, 34, 0.6);
      margin: 8px;
      border-radius: 12px;
      border: 1px solid #2b2b3a;
      scroll-behavior: smooth;
      -webkit-overflow-scrolling: touch;
    }

    .bubble {
      padding: 12px 16px;
      border-radius: 16px;
      margin: 8px 0;
      max-width: 85%;
      word-wrap: break-word;
      position: relative;
      animation: slideIn 0.3s ease;
    }

    @keyframes slideIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .user {
      background: linear-gradient(135deg, #2b5cff 0%, #1d47d1 100%);
      color: white;
      margin-left: auto;
      border-bottom-right-radius: 4px;
    }

    .bot {
      background: linear-gradient(135deg, #1f9a3a 0%, #16803d 100%);
      color: white;
      margin-right: auto;
      border-bottom-left-radius: 4px;
    }

    .code-bubble {
      background: var(--code);
      color: #d6e0f5;
      font-family: 'Courier New', monospace;
      white-space: pre-wrap;
      border: 1px solid #334;
      max-width: 95%;
    }

    .input-container {
      padding: 12px 16px;
      background: rgba(17, 26, 43, 0.95);
      border-top: 1px solid #2d2d4a;
      display: flex;
      gap: 8px;
      align-items: flex-end;
    }

    #userInput {
      flex: 1;
      padding: 12px 16px;
      border-radius: 24px;
      border: 2px solid #334;
      background: rgba(255, 255, 255, 0.1);
      color: var(--text);
      font-size: 16px;
      resize: none;
      min-height: 44px;
      max-height: 120px;
      transition: border-color 0.2s;
    }

    #userInput:focus {
      outline: none;
      border-color: var(--accent);
    }

    #userInput::placeholder {
      color: var(--muted);
    }

    .send-btn {
      background: var(--accent);
      color: #062f1c;
      border: none;
      border-radius: 50%;
      width: 44px;
      height: 44px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      font-weight: bold;
      transition: all 0.2s;
      touch-action: manipulation;
    }

    .send-btn:hover {
      background: #22c55e;
      transform: scale(1.05);
    }

    .send-btn:active {
      transform: scale(0.95);
    }

    .control-group {
      padding: 16px;
      border-bottom: 1px solid #2d2d4a;
    }

    .control-title {
      font-size: 0.9rem;
      font-weight: 600;
      color: var(--accent);
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .mode-buttons {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 6px;
      margin-bottom: 12px;
    }

    .mode-btn {
      padding: 8px 4px;
      border: 1px solid #445;
      background: rgba(255, 255, 255, 0.05);
      color: var(--text);
      border-radius: 6px;
      font-size: 0.8rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
      text-align: center;
    }

    .mode-btn.active {
      background: var(--accent);
      color: #062f1c;
      border-color: var(--accent);
    }

    .param-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-top: 12px;
    }

    .param-item {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .param-label {
      font-size: 0.8rem;
      color: var(--muted);
      font-weight: 500;
    }

    .param-input {
      padding: 6px 8px;
      border-radius: 4px;
      border: 1px solid #445;
      background: rgba(255, 255, 255, 0.1);
      color: var(--text);
      font-size: 0.85rem;
    }

    .range-input {
      -webkit-appearance: none;
      width: 100%;
      height: 4px;
      background: #445;
      border-radius: 2px;
      outline: none;
    }

    .range-input::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 16px;
      height: 16px;
      background: var(--accent);
      border-radius: 50%;
      cursor: pointer;
    }

    .param-value {
      font-size: 0.75rem;
      color: var(--accent);
      text-align: center;
      font-weight: 600;
    }

    .generate-btn {
      width: 100%;
      padding: 10px;
      background: var(--accent);
      color: #062f1c;
      border: none;
      border-radius: 6px;
      font-weight: 600;
      cursor: pointer;
      margin-top: 12px;
      transition: all 0.2s;
    }

    .generate-btn:hover {
      background: #22c55e;
    }

    .code-output {
      background: var(--code);
      color: #d6e0f5;
      padding: 12px;
      border-radius: 6px;
      font-family: 'Courier New', monospace;
      font-size: 0.75rem;
      white-space: pre-wrap;
      max-height: 200px;
      overflow-y: auto;
      margin-top: 8px;
      border: 1px solid #445;
    }

    .typing-indicator {
      display: none;
      padding: 12px 16px;
      color: var(--muted);
      font-style: italic;
      font-size: 0.9rem;
    }

    .typing-indicator.show {
      display: block;
      animation: fadeIn 0.3s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    .quick-actions {
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
      margin-top: 8px;
    }

    .quick-btn {
      padding: 6px 12px;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid #445;
      border-radius: 16px;
      font-size: 0.8rem;
      color: var(--text);
      cursor: pointer;
      transition: all 0.2s;
    }

    .quick-btn:hover {
      background: rgba(255, 255, 255, 0.2);
    }

    /* Touch-friendly improvements */
    @media (max-width: 768px) {
      .bubble { max-width: 95%; }
      .param-grid { grid-template-columns: 1fr; }
      #userInput { font-size: 16px; } /* Prevents zoom on iOS */
    }

    /* Scrollbar styling */
    ::-webkit-scrollbar {
      width: 6px;
    }

    ::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.1);
    }

    ::-webkit-scrollbar-thumb {
      background: var(--accent);
      border-radius: 3px;
    }
  </style>
</head>
<body>
  <div class="overlay" id="overlay"></div>
  
  <header class="header">
    <div class="logo">ü§ñ Smart Code Bot</div>
    <div class="status">
      <div class="status-dot"></div>
      <span>‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</span>
    </div>
    <button class="toggle-btn" id="toggleControls">‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</button>
  </header>

  <div class="main-container">
    <section class="chat-section">
      <div id="chat" role="log" aria-label="Chat messages">
        <div class="bubble bot">
          ‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡∏£‡∏±‡∏ö! ‡∏ú‡∏°‡∏Ñ‡∏∑‡∏≠ Smart Code Bot ‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏Ñ‡πâ‡∏î‡∏ï‡∏≤‡∏°‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ 
          ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏ú‡∏°‡∏™‡∏£‡πâ‡∏≤‡∏á ‡πÄ‡∏ä‡πà‡∏ô "‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå To-Do List" ‡∏´‡∏£‡∏∑‡∏≠ "‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô API ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö user management"
        </div>
      </div>
      
      <div class="typing-indicator" id="typingIndicator">
        ü§ñ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡∏¥‡∏î‡πÅ‡∏•‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏Ñ‡πâ‡∏î...
      </div>

      <div class="input-container">
        <div class="quick-actions">
          <button class="quick-btn" onclick="insertQuickCommand('‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå To-Do List ‡πÅ‡∏ö‡∏ö responsive')">üìù To-Do App</button>
          <button class="quick-btn" onclick="insertQuickCommand('‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô API REST ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö user management')">üîê User API</button>
          <button class="quick-btn" onclick="insertQuickCommand('‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏Å‡∏° Snake ‡∏î‡πâ‡∏ß‡∏¢ HTML Canvas')">üéÆ ‡πÄ‡∏Å‡∏° Snake</button>
        </div>
        <div style="display: flex; gap: 8px; align-items: flex-end; width: 100%;">
          <textarea 
            id="userInput" 
            placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏Ñ‡πâ‡∏î ‡πÄ‡∏ä‡πà‡∏ô '‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå portfolio' ‡∏´‡∏£‡∏∑‡∏≠ '‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô chatbot'"
            rows="1"
          ></textarea>
          <button class="send-btn" id="sendBtn" aria-label="Send message">‚û§</button>
        </div>
      </div>
    </section>

    <aside class="controls-section" id="controlsSection">
      <div class="control-group">
        <div class="control-title">üéØ ‡πÇ‡∏´‡∏°‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</div>
        <div class="mode-buttons">
          <button class="mode-btn active" data-mode="speed">‚ö° ‡πÄ‡∏£‡πá‡∏ß</button>
          <button class="mode-btn" data-mode="quality">üíé ‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û</button>
          <button class="mode-btn" data-mode="balanced">‚öñÔ∏è ‡∏™‡∏°‡∏î‡∏∏‡∏•</button>
        </div>
      </div>

      <div class="control-group">
        <div class="control-title">üîß ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ API</div>
        <div style="display: flex; flex-direction: column; gap: 8px;">
          <input 
            id="endpoint" 
            type="url" 
            placeholder="API Endpoint" 
            class="param-input"
            value="https://api.openai.com/v1/chat/completions"
          />
          <input 
            id="apiKey" 
            type="password" 
            placeholder="API Key" 
            class="param-input"
          />
        </div>
      </div>

      <div class="control-group">
        <div class="control-title">‚öôÔ∏è ‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå</div>
        <div class="param-grid">
          <div class="param-item">
            <label class="param-label">Model</label>
            <select id="modelSelect" class="param-input">
              <option value="gpt-4">GPT-4</option>
              <option value="gpt-3.5-turbo">GPT-3.5 Turbo</option>
              <option value="claude-3">Claude-3</option>
            </select>
          </div>

          <div class="param-item">
            <label class="param-label">Max Tokens</label>
            <input id="maxTokens" type="number" min="100" max="4000" value="2000" class="param-input">
          </div>

          <div class="param-item">
            <label class="param-label">Temperature</label>
            <input id="temp" type="range" min="0" max="1" step="0.1" value="0.7" class="range-input">
            <div class="param-value" id="tempVal">0.7</div>
          </div>

          <div class="param-item">
            <label class="param-label">Top P</label>
            <input id="topP" type="range" min="0" max="1" step="0.1" value="0.9" class="range-input">
            <div class="param-value" id="topPVal">0.9</div>
          </div>
        </div>

        <button class="generate-btn" id="generateCode">üöÄ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏Ñ‡πâ‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á</button>
        <div class="code-output" id="codeOutput">// Code output will appear here</div>
      </div>

      <div class="control-group">
        <div class="control-title">üìä ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥</div>
        <div style="font-size: 0.8rem; color: var(--muted);">
          <div>Messages: <span id="messageCount">0</span></div>
          <div>Tokens used: <span id="tokenCount">~0</span></div>
          <div>Mode: <span id="currentMode">‡πÄ‡∏£‡πá‡∏ß</span></div>
        </div>
      </div>
    </aside>
  </div>

  <script>
    // State management
    let currentMode = 'speed';
    let messages = [];
    let messageCount = 0;
    let estimatedTokens = 0;

    // DOM elements
    const chatEl = document.getElementById('chat');
    const userInput = document.getElementById('userInput');
    const sendBtn = document.getElementById('sendBtn');
    const typingIndicator = document.getElementById('typingIndicator');
    const toggleControls = document.getElementById('toggleControls');
    const controlsSection = document.getElementById('controlsSection');
    const overlay = document.getElementById('overlay');
    const modeButtons = document.querySelectorAll('.mode-btn');
    const tempSlider = document.getElementById('temp');
    const topPSlider = document.getElementById('topP');
    const tempVal = document.getElementById('tempVal');
    const topPVal = document.getElementById('topPVal');
    const generateCodeBtn = document.getElementById('generateCode');
    const codeOutput = document.getElementById('codeOutput');
    const messageCountEl = document.getElementById('messageCount');
    const tokenCountEl = document.getElementById('tokenCount');
    const currentModeEl = document.getElementById('currentMode');

    // Auto-resize textarea
    userInput.addEventListener('input', function() {
      this.style.height = 'auto';
      this.style.height = this.scrollHeight + 'px';
    });

    // Toggle controls panel
    toggleControls.addEventListener('click', () => {
      controlsSection.classList.toggle('open');
      overlay.classList.toggle('show');
    });

    overlay.addEventListener('click', () => {
      controlsSection.classList.remove('open');
      overlay.classList.remove('show');
    });

    // Mode selection
    modeButtons.forEach(btn => {
      btn.addEventListener('click', () => {
        modeButtons.forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        currentMode = btn.dataset.mode;
        currentModeEl.textContent = btn.textContent;
        optimizeParameters();
      });
    });

    // Parameter updates
    tempSlider.addEventListener('input', () => {
      tempVal.textContent = tempSlider.value;
    });

    topPSlider.addEventListener('input', () => {
      topPVal.textContent = topPSlider.value;
    });

    // Quick command insertion
    function insertQuickCommand(command) {
      userInput.value = command;
      userInput.focus();
    }

    // Add message to chat
    function addMessage(role, content, isCode = false) {
      const bubble = document.createElement('div');
      bubble.className = `bubble ${role}${isCode ? ' code-bubble' : ''}`;
      
      if (role === 'user') {
        bubble.textContent = content;
      } else {
        bubble.innerHTML = formatBotMessage(content, isCode);
      }
      
      chatEl.appendChild(bubble);
      chatEl.scrollTop = chatEl.scrollHeight;
      
      messageCount++;
      messageCountEl.textContent = messageCount;
      estimatedTokens += Math.ceil(content.length / 4);
      tokenCountEl.textContent = `~${estimatedTokens}`;
    }

    // Format bot messages
    function formatBotMessage(content, isCode) {
      if (isCode) {
        return content;
      }
      
      // Simple markdown-like formatting
      return content
        .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
        .replace(/\*(.*?)\*/g, '<em>$1</em>')
        .replace(/`(.*?)`/g, '<code style="background: rgba(255,255,255,0.1); padding: 2px 4px; border-radius: 3px;">$1</code>');
    }

    // Optimize parameters based on mode
    function optimizeParameters() {
      const maxTokensEl = document.getElementById('maxTokens');
      
      switch(currentMode) {
        case 'speed':
          tempSlider.value = '0.3';
          topPSlider.value = '0.8';
          maxTokensEl.value = '1000';
          break;
        case 'quality':
          tempSlider.value = '0.7';
          topPSlider.value = '0.9';
          maxTokensEl.value = '3000';
          break;
        case 'balanced':
          tempSlider.value = '0.5';
          topPSlider.value = '0.85';
          maxTokensEl.value = '2000';
          break;
      }
      
      tempVal.textContent = tempSlider.value;
      topPVal.textContent = topPSlider.value;
    }

    // Generate code example
    generateCodeBtn.addEventListener('click', () => {
      const params = {
        model: document.getElementById('modelSelect').value,
        temperature: parseFloat(tempSlider.value),
        max_tokens: parseInt(document.getElementById('maxTokens').value),
        top_p: parseFloat(topPSlider.value)
      };
      
      const codeExample = `// API Call Example
const response = await fetch('${document.getElementById('endpoint').value}', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    'Authorization': 'Bearer YOUR_API_KEY'
  },
  body: JSON.stringify({
    model: "${params.model}",
    messages: [
      {role: "system", content: "You are a helpful coding assistant"},
      {role: "user", content: "Create a responsive website"}
    ],
    temperature: ${params.temperature},
    max_tokens: ${params.max_tokens},
    top_p: ${params.top_p}
  })
});

const data = await response.json();
console.log(data.choices[0].message.content);`;
      
      codeOutput.textContent = codeExample;
    });

    // Simulate AI response (replace with actual API call)
    async function simulateAIResponse(userMessage) {
      // Show typing indicator
      typingIndicator.classList.add('show');
      
      await new Promise(resolve => setTimeout(resolve, 1500 + Math.random() * 2000));
      
      // Hide typing indicator
      typingIndicator.classList.remove('show');
      
      // Simulate different types of responses based on keywords
      if (userMessage.includes('‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå') || userMessage.includes('website')) {
        return {
          message: "‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö! ‡∏ú‡∏°‡∏à‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ",
          code: generateWebsiteCode(userMessage)
        };
      } else if (userMessage.includes('API') || userMessage.includes('backend')) {
        return {
          message: "‡∏ú‡∏°‡∏à‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á API backend ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏∏‡∏ì",
          code: generateAPICode(userMessage)
        };
      } else if (userMessage.includes('‡πÄ‡∏Å‡∏°') || userMessage.includes('game')) {
        return {
          message: "‡∏™‡∏ô‡∏∏‡∏Å‡∏î‡∏µ! ‡∏°‡∏≤‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏Å‡∏°‡∏Å‡∏±‡∏ô‡πÄ‡∏•‡∏¢",
          code: generateGameCode(userMessage)
        };
      } else {
        return {
          message: "‡∏ú‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÅ‡∏•‡πâ‡∏ß ‡πÉ‡∏´‡πâ‡∏ú‡∏°‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏Ñ‡πâ‡∏î‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£",
          code: generateGenericCode(userMessage)
        };
      }
    }

    // Code generators (simplified examples)
    function generateWebsiteCode(request) {
      return `<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Website</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
        }
        .container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }
        header { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem 0;
            text-align: center;
        }
        .hero { padding: 4rem 0; background: #f8f9fa; }
        .features { padding: 3rem 0; }
        .feature-grid { 
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }
        .feature-card {
            background: white;
            padding: 2rem;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }
        .feature-card:hover { transform: translateY(-5px); }
        footer { background: #333; color: white; padding: 2rem 0; text-align: center; }
        @media (max-width: 768px) {
            .feature-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <h1>Welcome to My Website</h1>
            <p>‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏î‡πâ‡∏ß‡∏¢ Smart Code Bot</p>
        </div>
    </header>
    
    <section class="hero">
        <div class="container">
            <h2>Modern Responsive Design</h2>
            <p>‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏ó‡∏∏‡∏Å‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</p>
        </div>
    </section>
    
    <section class="features">
        <div class="container">
            <h2>Features</h2>
            <div class="feature-grid">
                <div class="feature-card">
                    <h3>üì± Responsive</h3>
                    <p>‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏ó‡∏∏‡∏Å‡∏Ç‡∏ô‡∏≤‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠</p>
                </div>
                <div class="feature-card">
                    <h3>‚ö° Fast</h3>
                    <p>‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏£‡πá‡∏ß ‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡∏™‡∏π‡∏á</p>
                </div>
                <div class="feature-card">
                    <h3>üé® Modern</h3>
                    <p>‡∏î‡∏µ‡πÑ‡∏ã‡∏ô‡πå‡∏ó‡∏±‡∏ô‡∏™‡∏°‡∏±‡∏¢ ‡∏™‡∏ß‡∏¢‡∏á‡∏≤‡∏°</p>
                </div>
            </div>
        </div>
    </section>
    
    <footer>
        <div class="container">
            <p>&copy; 2025 My Website. Created with Smart Code Bot.</p>
        </div>
    </footer>
</body>
</html>`;
    }

    function generateAPICode(request) {
      return `// Node.js Express API
const express = require('express');
const cors = require('cors');
const app = express();

// Middleware
app.use(cors());
app.use(express.json());

// Sample data
let users = [
    { id: 1, name: 'John Doe', email: 'john@example.com' },
    { id: 2, name: 'Jane Smith', email: 'jane@example.com' }
];

// Routes
app.get('/api/users', (req, res) => {
    res.json({ success: true, data: users });
});

app.get('/api/users/:id', (req, res) => {
    const user = users.find(u => u.id === parseInt(req.params.id));
    if (!user) return res.status(404).json({ success: false, message: 'User not found' });
    res.json({ success: true, data: user });
});

app.post('/api/users', (req, res) => {
    const { name, email } = req.body;
    const newUser = {
        id: users.length + 1,
        name,
        email
    };
    users.push(newUser);
    res.status(201).json({ success: true, data: newUser });
});

app.put('/api/users/:id', (req, res) => {
    const user = users.find(u => u.id === parseInt(req.params.id));
    if (!user) return res.status(404).json({ success: false, message: 'User not found' });
    
    const { name, email } = req.body;
    user.name = name || user.name;
    user.email = email || user.email;
    
    res.json({ success: true, data: user });
});

app.delete('/api/users/:id', (req, res) => {
    const index = users.findIndex(u => u.id === parseInt(req.params.id));
    if (index === -1) return res.status(404).json({ success: false, message: 'User not found' });
    
    users.splice(index, 1);
    res.json({ success: true, message: 'User deleted' });
});

const PORT = process.env.PORT || 3000;
app.listen(PORT, () => {
    console.log(\`Server running on port \${PORT}\`);
});

// package.json
{
  "name": "user-api",
  "version": "1.0.0",
  "scripts": {
    "start": "node server.js",
    "dev": "nodemon server.js"
  },
  "dependencies": {
    "express": "^4.18.0",
    "cors": "^2.8.5"
  },
  "devDependencies": {
    "nodemon": "^2.0.20"
  }
}`;
    }

    function generateGameCode(request) {
      return `<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Snake Game</title>
    <style>
        body { 
            margin: 0; 
            padding: 20px;
            background: #222; 
            color: white; 
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        canvas { 
            border: 2px solid #fff; 
            background: #000;
            touch-action: none;
        }
        .controls { 
            margin: 20px 0; 
            display: grid;
            grid-template-columns: repeat(3, 60px);
            gap: 10px;
            justify-items: center;
        }
        .btn { 
            width: 50px; 
            height: 50px; 
            border: none; 
            background: #4CAF50; 
            color: white; 
            border-radius: 5px;
            font-size: 20px;
            cursor: pointer;
        }
        .score { font-size: 24px; margin: 10px 0; }
        @media (max-width: 600px) {
            canvas { width: 90vw; height: 90vw; }
        }
    </style>
</head>
<body>
    <h1>üêç Snake Game</h1>
    <div class="score">Score: <span id="score">0</span></div>
    <canvas id="gameCanvas" width="400" height="400"></canvas>
    
    <div class="controls">
        <div></div>
        <button class="btn" onclick="changeDirection('up')">‚Üë</button>
        <div></div>
        <button class="btn" onclick="changeDirection('left')">‚Üê</button>
        <button class="btn" onclick="resetGame()">üîÑ</button>
        <button class="btn" onclick="changeDirection('right')">‚Üí</button>
        <div></div>
        <button class="btn" onclick="changeDirection('down')">‚Üì</button>
        <div></div>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const scoreElement = document.getElementById('score');

        const gridSize = 20;
        const tileCount = canvas.width / gridSize;

        let snake = [{ x: 10, y: 10 }];
        let food = { x: 15, y: 15 };
        let dx = 0, dy = 0;
        let score = 0;

        function drawGame() {
            clearCanvas();
            moveSnake();
            drawSnake();
            drawFood();
            checkGameEnd();
        }

        function clearCanvas() {
            ctx.fillStyle = 'black';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
        }

        function drawSnake() {
            ctx.fillStyle = 'lime';
            snake.forEach(segment => {
                ctx.fillRect(segment.x * gridSize, segment.y * gridSize, gridSize - 2, gridSize - 2);
            });
        }

        function drawFood() {
            ctx.fillStyle = 'red';
            ctx.fillRect(food.x * gridSize, food.y * gridSize, gridSize - 2, gridSize - 2);
        }

        function moveSnake() {
            const head = { x: snake[0].x + dx, y: snake[0].y + dy };
            snake.unshift(head);

            if (head.x === food.x && head.y === food.y) {
                score += 10;
                scoreElement.textContent = score;
                generateFood();
            } else {
                snake.pop();
            }
        }

        function generateFood() {
            food = {
                x: Math.floor(Math.random() * tileCount),
                y: Math.floor(Math.random() * tileCount)
            };
        }

        function changeDirection(direction) {
            switch(direction) {
                case 'up': if (dy === 0) { dx = 0; dy = -1; } break;
                case 'down': if (dy === 0) { dx = 0; dy = 1; } break;
                case 'left': if (dx === 0) { dx = -1; dy = 0; } break;
                case 'right': if (dx === 0) { dx = 1; dy = 0; } break;
            }
        }

        function checkGameEnd() {
            const head = snake[0];
            
            if (head.x < 0 || head.x >= tileCount || head.y < 0 || head.y >= tileCount) {
                resetGame();
            }
            
            for (let i = 4; i < snake.length; i++) {
                if (head.x === snake[i].x && head.y === snake[i].y) {
                    resetGame();
                }
            }
        }

        function resetGame() {
            snake = [{ x: 10, y: 10 }];
            food = { x: 15, y: 15 };
            dx = 0; dy = 0;
            score = 0;
            scoreElement.textContent = score;
        }

        // Keyboard controls
        document.addEventListener('keydown', (e) => {
            switch(e.key) {
                case 'ArrowUp': changeDirection('up'); break;
                case 'ArrowDown': changeDirection('down'); break;
                case 'ArrowLeft': changeDirection('left'); break;
                case 'ArrowRight': changeDirection('right'); break;
            }
        });

        // Touch controls
        let touchStartX, touchStartY;
        canvas.addEventListener('touchstart', (e) => {
            touchStartX = e.touches[0].clientX;
            touchStartY = e.touches[0].clientY;
        });

        canvas.addEventListener('touchend', (e) => {
            if (!touchStartX || !touchStartY) return;
            
            const touchEndX = e.changedTouches[0].clientX;
            const touchEndY = e.changedTouches[0].clientY;
            
            const diffX = touchStartX - touchEndX;
            const diffY = touchStartY - touchEndY;
            
            if (Math.abs(diffX) > Math.abs(diffY)) {
                changeDirection(diffX > 0 ? 'left' : 'right');
            } else {
                changeDirection(diffY > 0 ? 'up' : 'down');
            }
        });

        // Start game
        setInterval(drawGame, 200);
    </script>
</body>
</html>`;
    }

    function generateGenericCode(request) {
      return `// Generated Code Template
// Request: ${request}

<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generated App</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: system-ui, -apple-system, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .app { 
            background: white;
            padding: 2rem;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            max-width: 500px;
            width: 90%;
        }
        .title { 
            font-size: 2rem;
            color: #333;
            margin-bottom: 1rem;
            text-align: center;
        }
        .content { 
            color: #666;
            line-height: 1.6;
            text-align: center;
        }
        .btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            margin-top: 1rem;
            transition: all 0.3s ease;
        }
        .btn:hover { 
            background: #5a6fd8;
            transform: translateY(-2px);
        }
    </style>
</head>
<body>
    <div class="app">
        <h1 class="title">üöÄ Generated App</h1>
        <div class="content">
            <p>This is a template generated based on your request:</p>
            <p><strong>"${request}"</strong></p>
            <p>You can customize this code further to meet your specific needs.</p>
            <button class="btn" onclick="alert('Hello from generated code!')">
                Click Me!
            </button>
        </div>
    </div>
    
    <script>
        console.log('Generated app loaded successfully!');
        console.log('Request was: ${request}');
        
        // Add your custom JavaScript here
        document.querySelector('.btn').addEventListener('click', () => {
            console.log('Button clicked!');
        });
    </script>
</body>
</html>`;
    }

    // Send message handler
    async function handleSend() {
      const text = userInput.value.trim();
      if (!text) return;

      // Add user message
      addMessage('user', text);
      userInput.value = '';
      userInput.style.height = 'auto';

      // Get AI response
      try {
        const response = await simulateAIResponse(text);
        
        // Add bot message
        addMessage('bot', response.message);
        
        // Add code if available
        if (response.code) {
          setTimeout(() => {
            addMessage('bot', response.code, true);
          }, 500);
        }

        // Store message in history
        messages.push(
          { role: 'user', content: text },
          { role: 'assistant', content: response.message + (response.code ? '\n\n' + response.code : '') }
        );

      } catch (error) {
        addMessage('bot', '‡∏Ç‡∏≠‡∏≠‡∏†‡∏±‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.message);
      }
    }

    // Event listeners
    sendBtn.addEventListener('click', handleSend);
    userInput.addEventListener('keydown', (e) => {
      if (e.key === 'Enter' && !e.shiftKey) {
        e.preventDefault();
        handleSend();
      }
    });

    // Initialize
    optimizeParameters();
    generateCodeBtn.click(); // Generate initial code example
  </script>
</body>
</html>
